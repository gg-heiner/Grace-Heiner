(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[108],{1476:function(e,t,n){"use strict";n.r(t),n.d(t,"FormsPlugin",(function(){return u})),n.d(t,"formsTokenRefreshBeforeExpiryMs",(function(){return d})),n.d(t,"formsTokenEndpoint",(function(){return m})),n.d(t,"formsTokenFeatureName",(function(){return l}));var i=n(0),o=n(747),r=n(751),s=n(206),a=n(7),c=n(46),u=function(){function e(e,t){var n=this;this.videoContext=e,this.metaOverlayPlugin=t,this.getFormsAccessToken=void 0===this.videoContext.getAuthResult?void 0:function(){return Object(i.b)(n,void 0,void 0,(function(){var e;return Object(i.e)(this,(function(t){switch(t.label){case 0:return this.isCachedFormsTokenValid()?[2,this.cachedFormsAuthToken.token]:[3,1];case 1:return t.trys.push([1,4,,5]),this.videoContext.getAuthResult?[4,this.videoContext.getAuthResult(m,l,!1)]:[3,3];case 2:if((e=t.sent()).token)return this.cachedFormsAuthToken=e.token,[2,e.token.token];this.videoContext.loggingService.warnThin(f,{staticMessage:"Tokenless authResult",message:a.b.NotApplicable,stack:a.c.NotApplicable}),t.label=3;case 3:return[2,""];case 4:return t.sent(),this.videoContext.loggingService.warnThin(f,{staticMessage:"getExternalAuthResult failure",message:a.b.NotApplicable,stack:a.c.NotApplicable}),[2,""];case 5:return[2]}}))}))},this.isCachedFormsTokenValid=function(){return void 0!==n.cachedFormsAuthToken&&n.cachedFormsAuthToken.expiry.getTime()-Date.now()>d},this.onFormViewed=function(e,t){try{n.videoContext.markFormAsViewed(e,t.id,n.videoContext.userSession),n.videoContext.loggingService.appLogicThin("FormMarkedAsViewed",{formId:t.eventData.formId,formTime:t.start,videoEventId:t.id})}catch(e){}},this.onFormOpened=function(e,t,i){n.metaOverlayPlugin&&n.metaOverlayPlugin.setVisibility(!1),n.logUserAction(t,h,i||"")},this.onFormClosed=function(e,t,i,o){n.metaOverlayPlugin&&n.metaOverlayPlugin.setVisibility(!0),n.logUserAction(t,g,o)},this.onFormUserInteraction=function(e,t,i){n.logUserAction(t,v,i)},this.logUserAction=function(e,t,i){n.videoContext.loggingService.userActionThin(t,{formId:e.eventData.formId,formTime:e.start,videoEventId:e.id,timeStampMs:performance.now(),elementId:i,viewContext:n.videoContext.telemetryViewContext,actionType:"Unknown"})},this.initialize()}return e.getVideoDuration=function(e){return e.media?Object(o.b)(e.media.duration):0},e.prototype.initialize=function(){var e=this,t=this.videoContext.streamVideoPlayer,n=this.videoContext.video;if(!t||!n){var i="Try load formsPlugin before context has ";return!t&&(i+="streamPlayer, "),!n&&(i+="video"),void Object(c.b)(this.videoContext.loggingService,i)}this.getFormsAndNormalize(n.id,this.videoContext.userSession).then((function(i){if(i.length>0){var o=e.getTimedMediaEventInfo(n,i);t.player.loadPlugins({timedMediaEventPlugin:o}),e.videoContext.loggingService.appLogicThin("TMEPluginLoaded",{})}})).catch((function(t){var n=Object(s.a)(t);Object(c.b)(e.videoContext.loggingService,"Loading timedMediaEventPlugin on AMP",n)}))},e.prototype.getFormsAndNormalize=function(e,t){return Object(i.b)(this,void 0,void 0,(function(){var n,o,c;return Object(i.e)(this,(function(i){switch(i.label){case 0:this.videoContext.loggingService.appLogicThin("GetFormsStarted",{viewContext:this.videoContext.telemetryViewContext}),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.videoContext.getForms(e,t)];case 2:return n=i.sent(),[2,Object(r.b)(n)];case 3:return o=i.sent(),c=Object(s.a)(o),this.videoContext.loggingService.fatalThin("GetFormsFailed",{staticMessage:"getFormsAndNormalize failure",message:void 0!==c.message?c.message:a.b.Missing,stack:void 0!==c.stack?c.stack:(new Error).stack||a.c.Missing}),[2,Promise.reject()];case 4:return[2]}}))}))},e.prototype.getTimedMediaEventInfo=function(t,n){return{videoEvents:n,videoId:t.id,videoDuration:e.getVideoDuration(t),zOrder:200,formsCallbacks:{onFormClosed:this.onFormClosed,onFormOpened:this.onFormOpened,onFormUserInteraction:this.onFormUserInteraction,onFormViewed:this.onFormViewed,onGetFormsToken:this.getFormsAccessToken}}},e}(),d=9e5,m="/ExchangeToken/Forms",l="ExchangeFormsToken",v="InteractWithForm",h="OpenForm",g="CloseForm",f="FormsTokenFailed"},747:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var i,o=new RegExp(/^PT(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?$/),r=/((?:[0-9]?[0-9]:)?(?:[0-5]?[0-9]):(?:[0-5][0-9])(?!\d{1,})(?!\s?AM|PM|am|pm))/g;function s(e){var t=o.exec(e);return t?3600*a(t[i.Hour])+60*a(t[i.Minute])+a(t[i.Second]):NaN}function a(e){if(!e)return 0;var t=parseFloat(e);return isNaN(t)?NaN:t}function c(e){var t=e.split(":").reverse(),n=0;return t[0]&&(n+=parseInt(t[0],10)),t[1]&&(n+=60*parseInt(t[1],10)),t[2]&&(n+=60*parseInt(t[2],10)*60),n}!function(e){e[e.Hour=1]="Hour",e[e.Minute=2]="Minute",e[e.Second=3]="Second"}(i||(i={}))},751:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var i=n(0),o=n(747);function r(e,t){var n,r=[];return t&&t.media&&t.media.duration&&(n=Object(o.b)(t.media.duration)),e&&e.filter((function(e){return"form"===e.type&&!e.hidden&&e.eventData})).forEach((function(e){var t=Object(o.b)(e.start),s=Object(o.b)(e.end),a=Object(i.a)(Object(i.a)({},e),{startTime:t,endTime:s});a.eventData.hasBeenShown=e&&e.userData&&e.userData.isViewed,(!n||a.endTime<=n)&&r.push(a)})),r}function s(e){return e.replace("'","''")}}}]);